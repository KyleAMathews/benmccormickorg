<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><script type="text/javascript" src="//use.typekit.net/msd6bqv.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script><title data-react-helmet="true">marionette-service: Service Objects for Marionette | benmccormick.org</title><style>.header-link{color:hsla(0,0%,39%,.7)}.header-link:hover{color:#e2777a}.markdown pre{display:block;background:#fdf6e3;color:#657b83;overflow-y:hidden;padding:.2rem .5rem}.markdown pre code{background:none;border:none;border-radius:3px;display:inline-block;overflow:inherit;padding:0;white-space:inherit;word-wrap:normal;font-size:.7rem;line-height:1rem}code{border-radius:3px;white-space:pre;white-space:pre-wrap;white-space:pre-line;white-space:-pre-wrap;white-space:-o-pre-wrap;white-space:-moz-pre-wrap;white-space:-hp-pre-wrap;word-wrap:break-word;border:1px solid #ccc;display:inline;font-family:Inconsolata,monospace,serif;max-width:100%;overflow:auto;padding:0 .1625rem}.hljs,code{background:#fdf6e3;color:#657b83}.hljs{display:block;overflow-x:auto;padding:.5em}.hljs-comment,.hljs-quote{color:#93a1a1}.hljs-addition,.hljs-keyword,.hljs-selector-tag{color:#859900}.hljs-doctag,.hljs-literal,.hljs-meta .hljs-meta-string,.hljs-number,.hljs-regexp,.hljs-string{color:#2aa198}.hljs-name,.hljs-section,.hljs-selector-class,.hljs-selector-id,.hljs-title{color:#268bd2}.hljs-attr,.hljs-attribute,.hljs-class .hljs-title,.hljs-template-variable,.hljs-type,.hljs-variable{color:#b58900}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-meta .hljs-keyword,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-subst,.hljs-symbol{color:#cb4b16}.hljs-built_in,.hljs-deletion{color:#dc322f}.hljs-formula{background:#eee8d5}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}body,h1,h2,h3,h4,h5,h6,p{font-family:brandon-grotesque,Brandon Grotesque,Helvetica Neue,Helvetica,Arial,Lucida Sans,Geneva,Verdana,sans-serif;text-rendering:optimizeLegibility}a{color:#e2777a;text-decoration:none}blockquote{border-left:5px solid #57a3e8;font-style:italic;background:#eee;font-weight:400;font-size:.9rem;padding:10px 20px;margin:0 0 30px -25px}h2,h3{color:#57a3e8}.explanation{padding:10px;background:#eee;border-radius:10px;margin:20px auto;font-size:.85em}.reading-img img{width:150px;float:right;margin:10px}</style></head><body class="landing-page" style="background:#FCFCFC;"><div id="react-mount"><div style="max-width:39.984rem;margin-left:auto;margin-right:auto;padding:2.499rem 1.2495rem;" data-reactroot="" data-reactid="1" data-react-checksum="-515789413"><div style="display:flex;padding-bottom:0.5rem;margin-bottom:0.5rem;" data-reactid="2"><div style="flex-grow:3;display:flex;flex-direction:column;justify-content:space-around;" data-reactid="3"><h3 style="margin:0;padding-bottom:0;" data-reactid="4"><a style="box-shadow:none;text-decoration:none;color:inherit;" href="/benmccormickorg/" data-reactid="5">benmccormick.org</a></h3><div style="color:rgba(100,100,100, 0.7);" data-reactid="6"><a class="header-link" href="/benmccormickorg/subscribe/" data-reactid="7">Subscribe</a><span style="padding:0 0.33rem;" data-reactid="8">•</span><a class="header-link" href="/benmccormickorg/readinglist/" data-reactid="9">Reading List</a><span style="padding:0 0.33rem;" data-reactid="10">•</span><a class="header-link" href="http://twitter.com/ben336" data-reactid="11">Twitter</a><span style="padding:0 0.33rem;" data-reactid="12">•</span><a class="header-link" href="/benmccormickorg/about/" data-reactid="13">About</a></div></div><div style="flex-shrink:2;" data-reactid="14"><div data-reactid="15"></div></div></div><div class="markdown" data-reactid="16"><!-- react-empty: 17 --><h5 style="display:block;color:rgba(100,100,100, 0.7);margin-bottom:0.4165rem;" data-reactid="18">May 25, 2015</h5><h1 style="margin-top:0;margin-bottom:1rem;" data-reactid="19">marionette-service: Service Objects for Marionette</h1><div class="article-body" data-reactid="20"><p><a href="http://backbonejs.org/">Backbone.js</a> is a great way to structure web applications.  Its built in Models, Collections, Views and Routers are a very reasonable “minimum common ground” that pretty much any web project will be able to put to good use.  But more sophisticated applications have needs that extend beyond these basic concepts.  In addition to having some data that needs to be displayed, rich web apps often have resources and functionality that need to be shared across many different Views and Models.  There’s no definitive way to implement this consistently, but a common pattern is to create “services” of some type that Views and Models can communicate with.</p>
<p>This pattern is easiest to show with an example.  Let’s take a look at a simple logging implementation.  We might start out just using simple console commands throughout our code like this:</p>
<pre><code class="language-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doFoo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Do a thing</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'We did Foo'</span>);
}
</code></pre>
<p>That’s fine for a while, but what if we wanted to switch to a logging library like <a href="http://js.jsnlog.com/">JSNLog</a> or some 3rd party service?  We’d have a huge find and replace job to work through.  It’s better to centralize.  <a href="https://github.com/marionettejs/backbone.radio">Backbone.Radio</a> is perfect for this purpose.  We can use it to centralize our logic and create a logging module:</p>
<pre><code class="language-javascript"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> Radio <span class="hljs-keyword">from</span> <span class="hljs-string">'backbone.radio'</span>

<span class="hljs-keyword">let</span> loggingChannel = Radio.channel(<span class="hljs-string">'log'</span>);

loggingChannel.comply(<span class="hljs-string">'log'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">message</span>) </span>{
    <span class="hljs-built_in">console</span>.log(message);
});

loggingChannel.comply(<span class="hljs-string">'logError'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">message</span>) </span>{
    <span class="hljs-built_in">console</span>.error(message);
});

loggingChannel.comply(<span class="hljs-string">'logWarning'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">message</span>) </span>{
    <span class="hljs-built_in">console</span>.warn(message);
});
</code></pre>
<p>We could then log a message like this:</p>
<pre><code class="language-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doFoo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Do a thing</span>
  loggingChannel.command(<span class="hljs-string">'log'</span>, <span class="hljs-string">'We did Foo'</span>);
}
</code></pre>
<p>There are 2 main use cases for this sort of service pattern: centralizing common tasks and UI actions like logging or displaying an alert, and requesting a resource without having to worry about where it came from.  Both are easily possible using Backbone Radio, using code very similar to whats above.</p>
<p>Using Backbone Radio like this is a useful pattern, but it’s very ad hoc and imperative.  Not very Backbone-like.  What if we could follow the Marionette route of pulling a useful pattern into an object and allow it to be configured declaratively?  We could instead create a “Service Object” like this:</p>
<pre><code class="language-javascript"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> Mn <span class="hljs-keyword">from</span> <span class="hljs-string">'backbone.marionette'</span>

<span class="hljs-keyword">let</span> LoggingService = Mn.Service.extend({

    radioCommands: {
        <span class="hljs-string">'log log'</span>: <span class="hljs-string">'logMessage'</span>,
        <span class="hljs-string">'log logError'</span>: <span class="hljs-string">'logError'</span>,
        <span class="hljs-string">'log logWarning'</span>: <span class="hljs-string">'logWarning'</span>,
    },

    logMessage: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">message</span>) </span>{
        <span class="hljs-built_in">console</span>.log(message);
    },

    logError: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">message</span>) </span>{
        <span class="hljs-built_in">console</span>.error(message);
    },

    logWarning: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">message</span>) </span>{
        <span class="hljs-built_in">console</span>.warn(message);
    },
});

<span class="hljs-keyword">let</span> logger = <span class="hljs-keyword">new</span> LoggingService();
</code></pre>
<p>This is much more in the Backbone and Marionette style, with a declarative hash to delegate to different functions based on channels and the events passed.  It makes it much easier to create “service objects” to make functionality available in a decoupled way.</p>
<p>Declarative radio handling will be <a href="https://github.com/marionettejs/backbone.marionette/pull/2431">coming to Marionette Core</a> as part of Marionette version 3, but for now I’ve written a small library to make it available in the short term.</p>
<p><a href="https://github.com/benmccormick/marionette-service">marionette-service</a> provides the above Service Object to Marionette.  It allows you to listen to Radio Events, Commands or Requests, and associate them with callback functions.  It’s compatible with plans for Marionette v3, so all that will be required to remove it when upgrading will be a name change for service objects to use Marionette.Object rather than Marionette.Service. I’m excited to see how people use it.</p>
<p>Marionette-service is available to install both on <a href="https://www.npmjs.com/package/marionette-service">npm</a>, and <a href="http://bower.io/search/?q=marionette%20service">bower</a>.  Or you can clone the repo directly from <a href="https://github.com/benmccormick/marionette-service">Github</a>.</p>
<h3>More Resources</h3>
<ul>
<li>If you’re new to Backbone.Radio you can learn more about it from <a href="http://benmccormick.org/2015/01/26/backbone-radio/">my post</a>, or from the <a href="https://github.com/marionettejs/backbone.radio">official docs</a>.</li>
<li>If you’re confused why somebody would want to separate out the implementation of a service through Radio rather than passing a service object directly, <a href="http://arguments.callee.info/2009/05/18/javascript-design-patterns--mediator/">this is a nice piece by HB Stone</a> on the power of loose coupling and the Mediator Pattern</li>
</ul>
<h3>Subscribe</h3>
<p>Thanks for taking the time to read this post!  JavaScript development is one of the main topics of this blog, so if you enjoyed the post, please consider subscribing by using the <a href="http://feedpress.me/benmccormick">feed</a>, <a href="http://twitter.com/benmccormickorg">Twitter</a> or my <a href="http://eepurl.com/WFYon">mailing list</a>. You also might want to check out my other posts on <a href="http://benmccormick.org/marionette-explained/">building Backbone apps with Marionette</a>.</p>
</div><hr style="margin-bottom:3.332rem;" data-reactid="21"/><noscript data-reactid="22"></noscript><p style="margin-bottom:4.165rem;" data-reactid="23"><!-- react-text: 24 -->Written by <!-- /react-text --><!-- react-text: 25 -->Ben McCormick<!-- /react-text --></p></div><span style="display:block;clear:both;" data-reactid="26"> </span></div></div><script src="/benmccormickorg/bundle.js?t=1474688972841"></script></body></html>