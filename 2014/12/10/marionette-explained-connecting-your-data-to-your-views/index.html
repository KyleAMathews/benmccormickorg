<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png?v=yyxgnp97qG"/><link rel="icon" type="image/png" href="/favicon-32x32.png?v=yyxgnp97qG" sizes="32x32"/><link rel="icon" type="image/png" href="/favicon-16x16.png?v=yyxgnp97qG" sizes="16x16"/><link rel="manifest" href="/manifest.json?v=yyxgnp97qG"/><link rel="mask-icon" href="/safari-pinned-tab.svg?v=yyxgnp97qG" color="#57a3e8"/><link rel="shortcut icon" href="/favicon.ico?v=yyxgnp97qG"/><meta name="theme-color" content="#ffffff"/><script type="text/javascript" src="//use.typekit.net/msd6bqv.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script><title data-react-helmet="true">Marionette Explained: Connecting Data to Your Views | benmccormick.org</title><meta data-react-helmet="true" name="description" content="How to bind data to your views in Marionette.js"/><meta data-react-helmet="true" name="keywords" content="JavaScript Marionette.js Backbone MVC Model View"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:site" content="@benmccormickorg"/><meta data-react-helmet="true" name="twitter:creator" content="@ben336"/><meta data-react-helmet="true" name="twitter:title" content="Marionette Explained: Connecting Data to Your Views"/><meta data-react-helmet="true" name="twitter:description" content="How to bind data to your views in Marionette.js"/><meta data-react-helmet="true" name="twitter:image" content="http://benmccormick.org/logo.png"/><script data-react-helmet="true" type="application/ld+json">{
                "@context": "http://schema.org"
                "@type": "BlogPosting",
                "headline": "Marionette Explained: Connecting Data to Your Views",
                "genre": "Software Development",
                "keywords": "JavaScript Marionette.js Backbone MVC Model View",
                "url": "http://benmccormick.org/2014/12/10/marionette-explained-connecting-your-data-to-your-views/",
                "image": "http://benmccormick.org/logo.png",
                "datePublished": "2014-12-10",
                "description": "How to bind data to your views in Marionette.js",
                "articleBody": "<p><em>This is the second post in a series on <a href=\"http://marionettejs.com/\">Marionette.js</a>.  For more background on what Marionette is, check out the first post in the series, <a href=\"http://benmccormick.org/2014/12/02/the-case-for-marionette-js/\">The Case For Marionette</a></em></p>
<p>One of the most interesting design choices of <a href=\"http://backbonejs.org/\">Backbone</a> was the decision to not provide a default render function for Views. Backbone Views by default are an empty function that adds nothing to the DOM when rendered.  Although a View can have a Model or Collection associated with it, there is no built in way to associate that with the generated View.  When you contrast that to other modern frameworks like Ember, Angular and KnockoutJS, and their emphasis on using 2 way bindings to associate a data object to a rendered View, Backbone can feel a bit incomplete.  The goal is to allow for a variety of rendering approaches, without making one of them a favored approach.  But it leaves a situation where choosing a rendering procedure is one of the first steps in any new Backbone project.  Marionette provides a structured approach for binding your data to your view layer, while still providing flexibility to introduce customization.</p>
<h3>Rendering and Data-Binding in Marionette</h3>
<p><img src=\"/posts/images/renderpattern-3.png\" alt=\"rendering diagram\"></p>
<p>Marionette.JS handles rendering in a way that is similar to the <a href=\"http://en.wikipedia.org/wiki/Model_View_ViewModel\">Model-View-ViewModel</a> pattern that developers who have used KnockoutJS or Durandal will be familiar with <sup id=\"fnref:1\"><a href=\"#fn:1\">1</a></sup>. Marionette implements its render cycle through 2 primary methods available in all of its base View classes.  The first is <code>serializeData</code>. serializeData is a function that produces what is essentially a <code>ViewModel</code> in the sense of an MVVM application. It takes your data (a Backbone Model or Collection), and pulls it into a simplified form that a View can easily render.  By default Marionette will simply call the Model or Collection’s <code>toJSON</code> function to serialize the Backbone object down into a simple JavaScript object.  But it’s possible to override serializeData to provide more complicated logic.  For instance here’s an example from the <a href=\"https://github.com/tastejs/todomvc/tree/gh-pages/examples/backbone_marionette\">Marionette TodoMVC project</a> that takes a collection of todos and calculates a few values to show the number of completed todos.</p>
<pre><code class=\"language-javascript\">serializeData: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\"></span>) </span>{
    <span class=\"hljs-keyword\">var</span> active = <span class=\"hljs-keyword\">this</span>.collection.getActive().length;
    <span class=\"hljs-keyword\">var</span> total = <span class=\"hljs-keyword\">this</span>.collection.length;

    <span class=\"hljs-keyword\">return</span> {
        <span class=\"hljs-attr\">activeCount</span>: active,
        <span class=\"hljs-attr\">totalCount</span>: total,
        <span class=\"hljs-attr\">completedCount</span>: total - active
    };
},
</code></pre>
<p>Once the serialized data/view model has been prepared, data is passed to the render function which starts by looking for a template to render.  In Marionette, templates are defined by setting the template property on your View, or by setting a getTemplate method if you want to conditionally load your templates. The render function takes that template, passes it the serialized data, and renders it using a template engine.  The default Marionette template engine is Underscore, which makes sense since it’s a Backbone dependency already.  But it’s easy to switch to a different templating engine.  Here’s the entire chunk of code I wrote to use Handlebar templates in Windsor Circle’s Marionette app.</p>
<pre><code class=\"language-javascript\"><span class=\"hljs-comment\">//render templates with Handlebars instead of Underscore</span>
Backbone.Marionette.Renderer.render = <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">template, data</span>)</span>{
    <span class=\"hljs-keyword\">var</span> renderer = Handlebars.compile(template);
    <span class=\"hljs-keyword\">return</span> renderer(data);
};
</code></pre>
<h3>ItemView and CollectionView</h3>
<p>Marionette provides several View classes that you can use as bases, but the core Views for representing data are ItemView and CollectionView.  An ItemView takes a single data object, either a Model or Collection and passes it to the template to render.  A CollectionView iterates over a Collection and renders a child View for each Model. You can either use the same View for every Collection, or mix and match Views based on the Model’s properties.</p>
<p>So for instance, views for a simple todo list might look something like this <sup id=\"fnref:2\"><a href=\"#fn:2\">2</a></sup>:</p>
<pre><code class=\"language-javascript\"><span class=\"hljs-keyword\">var</span> TodoView= Marionette.ItemView.extend({
    <span class=\"hljs-attr\">tagName</span>: <span class=\"hljs-string\">'li'</span>,
    <span class=\"hljs-attr\">template</span>: <span class=\"hljs-string\">'&lt;span class=\"checkbox\" {{checked}}&gt;&lt;/span&gt;&lt;span class=\"text\"&gt;{{ text}}&lt;/span&gt;&lt;span class=\"delete\"&gt;&lt;/span&gt;'</span>,
    <span class=\"hljs-attr\">events</span>: {
        <span class=\"hljs-string\">'click .checkbox'</span>: <span class=\"hljs-string\">'toggleChecked'</span>,
        <span class=\"hljs-string\">'click .delete'</span> : <span class=\"hljs-string\">'deleteItem'</span>
    },

    <span class=\"hljs-attr\">serializeData</span>: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{
        <span class=\"hljs-keyword\">return</span> {
            <span class=\"hljs-attr\">checked</span>: <span class=\"hljs-keyword\">this</span>.model.get(<span class=\"hljs-string\">'checked'</span>) ? <span class=\"hljs-string\">'checked'</span>:<span class=\"hljs-string\">''</span>,
            <span class=\"hljs-attr\">text</span>: <span class=\"hljs-keyword\">this</span>.model.get(<span class=\"hljs-string\">'text'</span>)
        };
    },

    <span class=\"hljs-attr\">toggleChecked</span>: <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{
        <span class=\"hljs-comment\">//logic for checking the box</span>
    },

    <span class=\"hljs-attr\">deleteItem</span> : <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\"></span>) </span>{
        <span class=\"hljs-comment\">//logic for deleting the todo</span>
    }
});

<span class=\"hljs-keyword\">var</span> TodoListView = Marionette.CollectionView.extend({
    <span class=\"hljs-attr\">childView</span>: TodoView,
    <span class=\"hljs-attr\">tagName</span>: <span class=\"hljs-string\">'ul'</span>

});
</code></pre>
<p>When the TodoListView is given a collection and rendered, it will display an unordered list of rendered TodoViews, with the data for each model bound to the template object associated with TodoView.</p>
<h3>A brief note on 2 way data-binding</h3>
<p>Marionette data-binding is one-way by default.  Over the last few years the discussion around data-binding has gone from “cool there’s structured data-binding” when Backbone first came out, to “how can you ship without 2-way data-bindings?” when Knockout, Angular and Ember popularized the 2-way approach, to “1 way bindings keep things simple and they’re cool again” based on the popularity of React.  I’m not going to go deep into that debate during this post, but the important takeaway is that Marionette generally prefers explicit bindings to implicit.  So when model values change, it will be based on code that you’ve written, not implicit library code.</p>
<h3>Wrap-Up</h3>
<p>I kept things pretty simple in this post, but consistent data binding is a core part of what Marionette provides.  Having a single documented system for attaching Model and Collection data to Views is a big win for keeping Backbone applications lean and readable.  When using these conventions you can move from View to View or project to project and quickly pick up on the intent and structure of the code.  Instead of trying to solve these problems for every  View, you can rely on the experience of others and focus on writing code to achieve your application’s goals.</p>
<p>This was a short but important start to diving deeper into Marionette. I’ll talk more about layouts, view life-cycles, and other Marionette features in future posts, but at their heart, web applications are about exposing data in rich UIs.  Without that core, your web applications won’t have much function at all.  So make sure to understand and take advantage of this aspect of Marionette before you move on to anything else.</p>
<h3>More Resources</h3>
<ul>
<li>If you absolutely must have 2 way data bindings in Backbone, <a href=\"http://nytimes.github.io/backbone.stickit/\">Backbone.stickit</a> is a good project to check out.  At Windsor Circle we use it for binding model data to forms (2 way data-binding’s best use case).  Rather than the template based approach most libaries use for 2 way data-binding, stickit allows you to configure bindings declaratively in your view code.</li>
</ul>
<h3>Subscribe</h3>
<p>Thanks for taking the time to read this post! This was the second post in a <a href=\"http://benmccormick.org/tag/marionette-explained/\">series</a> on developing web applications with Marionette.js, so if you enjoyed the post, please consider subscribing by using the <a href=\"http://feedpress.me/benmccormick\">feed</a>, <a href=\"http://twitter.com/benmccormickorg\">Twitter</a> or my <a href=\"http://eepurl.com/WFYon\">mailing list</a>. You also might want to check out the <a href=\"http://benmccormick.org/2014/12/02/the-case-for-marionette-js/\">first post</a> in the series, The Case For Marionette.js.</p>
<div class=\"footnotes\">
<ol>
    <li class=\"footnote\" id=\"fn:1\">
        <p>
        MVVM is normally associated with 2 ways bindings though, which Backbone and Marionette do not provide
        </p>
        <a href=\"#fnref:1\" title=\"return to article\"> ↩</a></p>
    </li>
    <li class=\"footnote\" id=\"fn:2\">
        <p>
        In practice Marionette developers would likely use a ui hash on the TodoView, pull the template out into a separate file, and might have the CollectionView be a CompositeView to provide structure around the list.  But I'll dive into all of those things in more detail in future posts.
        </p>
        <a href=\"#fnref:2\" title=\"return to article\"> ↩</a></p>
    </li>
</ol>
</div>
",
                  "author": {
                    "@type": "Person",
                    "name": "Ben McCormick"
                    "email": "mailto:ben@benmccormick.org",
                    "image": "/profile_pic.jpg",
                    "jobTitle": "Software Engineer",
                    "alumniOf": "Duke",
                    "birthPlace": "Pittsburgh, PA",
                    "gender": "male",
                    "url": "http://benmccormick.org",
              	    "sameAs" : [
                      "https://www.linkedin.com/in/benmccormick",
                      "http://twitter.com/ben336",
                    ]
                 }
              }</script><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font-size:112.5%;line-height:1.666em;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:georgia,serif;font-weight:normal;word-wrap:break-word;}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;color:hsla(0,0%,0%,0.8);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.5rem;line-height:2.499rem;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;color:hsla(0,0%,0%,0.8);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.27542rem;line-height:1.666rem;}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;color:hsla(0,0%,0%,0.8);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1.17608rem;line-height:1.666rem;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;color:hsla(0,0%,0%,0.8);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.666rem;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;color:hsla(0,0%,0%,0.8);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:0.92211rem;line-height:1.666rem;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;color:hsla(0,0%,0%,0.8);font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif;font-weight:bold;text-rendering:optimizeLegibility;font-size:0.88547rem;line-height:1.666rem;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;}ul{margin-left:1.666rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.666rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;font-size:0.85rem;line-height:1.666rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;font-size:1rem;line-height:1.666rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;}blockquote{margin-left:1.666rem;margin-right:1.666rem;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.666rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.666rem;}b{font-weight:bold;}strong{font-weight:bold;}dt{font-weight:bold;}th{font-weight:bold;}li{margin-bottom:calc(1.666rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.666rem;margin-bottom:calc(1.666rem / 2);margin-top:calc(1.666rem / 2);}li > ul{margin-left:1.666rem;margin-bottom:calc(1.666rem / 2);margin-top:calc(1.666rem / 2);}code{font-size:0.85rem;line-height:1.666rem;}kbd{font-size:0.85rem;line-height:1.666rem;}samp{font-size:0.85rem;line-height:1.666rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:tnum;padding-left:1.11067rem;padding-right:1.11067rem;padding-top:0.833rem;padding-bottom:calc(0.833rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}</style><style>.header-link{color:hsla(0,0%,39%,.7)}.header-link:hover{color:#e2777a}#carbonads{height:100px;font-size:14px;width:300px;position:relative;background:#f0f0f0}.carbon-wrap{height:100px;display:-ms-flexbox;display:flex}.carbon-text{padding:5px 10px;max-height:80px;display:inline-block;overflow:hidden;line-height:1.3}.carbon-poweredby{color:hsla(0,0%,39%,.7);position:absolute;right:5px;bottom:0}@media all and (max-width:600px){#carbonads,.no-mobile{display:none}}@media all and (max-width:321px){html{font-size:100%!important}}.markdown pre{display:block;background:#fdf6e3;color:#657b83;overflow-y:hidden;padding:.2rem .5rem}.markdown pre code{background:none;border:none;border-radius:3px;display:inline-block;overflow:inherit;padding:0;white-space:inherit;word-wrap:normal;font-size:.7rem;line-height:1rem}code{border-radius:3px;white-space:pre;white-space:pre-wrap;white-space:pre-line;white-space:-pre-wrap;white-space:-o-pre-wrap;white-space:-moz-pre-wrap;white-space:-hp-pre-wrap;word-wrap:break-word;border:1px solid #ccc;display:inline;font-family:Inconsolata,monospace,serif;max-width:100%;overflow:auto;padding:0 .1625rem}.hljs,code{background:#fdf6e3;color:#657b83}.hljs{display:block;overflow-x:auto;padding:.5em}.hljs-comment,.hljs-quote{color:#93a1a1}.hljs-addition,.hljs-keyword,.hljs-selector-tag{color:#859900}.hljs-doctag,.hljs-literal,.hljs-meta .hljs-meta-string,.hljs-number,.hljs-regexp,.hljs-string{color:#2aa198}.hljs-name,.hljs-section,.hljs-selector-class,.hljs-selector-id,.hljs-title{color:#268bd2}.hljs-attr,.hljs-attribute,.hljs-class .hljs-title,.hljs-template-variable,.hljs-type,.hljs-variable{color:#b58900}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-meta .hljs-keyword,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-subst,.hljs-symbol{color:#cb4b16}.hljs-built_in,.hljs-deletion{color:#dc322f}.hljs-formula{background:#eee8d5}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}html{font-size:120%}body,h1,h2,h3,h4,h5,h6,p{font-family:brandon-grotesque,Brandon Grotesque,Helvetica Neue,Helvetica,Arial,Lucida Sans,Geneva,Verdana,sans-serif;text-rendering:optimizeLegibility}a{color:#e2777a;text-decoration:none}blockquote{border-left:5px solid #57a3e8;font-style:italic;background:#eee;font-weight:400;font-size:.9rem;padding:10px 20px;margin:0 0 30px -25px}h2,h3{color:#57a3e8}.explanation{padding:10px;background:#eee;border-radius:10px;margin:20px auto;font-size:.85em}.article-body .reading-img img{width:150px;float:right;margin:0 10px 20px}.article-body img{max-height:200px;display:block;margin:40px auto 20px}.article-body img.full-width{max-height:none}.article-body img.half-width{max-height:none;width:50%}.mc-field-group{width:400px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:start;justify-content:flex-start;-ms-flex-align:start;align-items:flex-start;padding:8px 0}.mc-field-group input{border-radius:3px;max-width:350px;width:80vw;border:1px solid #ccc}.mc-field-group label{font-size:.9em;font-weight:600}#mc-embedded-subscribe{color:#fff;background:#57a3e8;border-radius:4px;border:0;padding:5px 10px;margin:20px 0;cursor:pointer}#mc-embedded-subscribe:hover{background:#3e8acf}</style></head><body class="landing-page" style="background:#FCFCFC;padding:0 10px;"><div id="react-mount"><div style="max-width:39.984rem;margin-left:auto;margin-right:auto;padding:2.499rem 1.2495rem;" data-reactroot="" data-reactid="1" data-react-checksum="-875869548"><div style="display:flex;padding-bottom:0.5rem;margin-bottom:0.5rem;" data-reactid="2"><div style="flex-grow:3;display:flex;flex-direction:column;justify-content:space-around;" data-reactid="3"><h3 style="margin:0;padding-bottom:0;" data-reactid="4"><a style="box-shadow:none;text-decoration:none;color:inherit;" href="/" data-reactid="5">benmccormick.org</a></h3><div style="color:rgba(100,100,100, 0.7);" data-reactid="6"><a class="header-link" href="/subscribe/" data-reactid="7">Subscribe</a><span style="padding:0 0.33rem;" data-reactid="8">•</span><a class="header-link" href="/readinglist/" data-reactid="9">Reading List</a><span style="padding:0 0.33rem;" data-reactid="10">•</span><a class="header-link" href="http://twitter.com/ben336" data-reactid="11">Twitter</a><span style="padding:0 0.33rem;" data-reactid="12">•</span><a class="header-link" href="/about/" data-reactid="13">About</a></div></div><div style="flex-shrink:2;" data-reactid="14"><span data-reactid="15"></span></div></div><div class="markdown" data-reactid="16"><!-- react-empty: 17 --><h5 style="display:block;color:rgba(100,100,100, 0.7);margin-bottom:0.4165rem;" data-reactid="18">December 10, 2014</h5><h1 style="margin-top:0;margin-bottom:1rem;" data-reactid="19">Marionette Explained: Connecting Data to Your Views</h1><div class="article-body" data-reactid="20"><p><em>This is the second post in a series on <a href="http://marionettejs.com/">Marionette.js</a>.  For more background on what Marionette is, check out the first post in the series, <a href="http://benmccormick.org/2014/12/02/the-case-for-marionette-js/">The Case For Marionette</a></em></p>
<p>One of the most interesting design choices of <a href="http://backbonejs.org/">Backbone</a> was the decision to not provide a default render function for Views. Backbone Views by default are an empty function that adds nothing to the DOM when rendered.  Although a View can have a Model or Collection associated with it, there is no built in way to associate that with the generated View.  When you contrast that to other modern frameworks like Ember, Angular and KnockoutJS, and their emphasis on using 2 way bindings to associate a data object to a rendered View, Backbone can feel a bit incomplete.  The goal is to allow for a variety of rendering approaches, without making one of them a favored approach.  But it leaves a situation where choosing a rendering procedure is one of the first steps in any new Backbone project.  Marionette provides a structured approach for binding your data to your view layer, while still providing flexibility to introduce customization.</p>
<h3>Rendering and Data-Binding in Marionette</h3>
<p><img src="/posts/images/renderpattern-3.png" alt="rendering diagram"></p>
<p>Marionette.JS handles rendering in a way that is similar to the <a href="http://en.wikipedia.org/wiki/Model_View_ViewModel">Model-View-ViewModel</a> pattern that developers who have used KnockoutJS or Durandal will be familiar with <sup id="fnref:1"><a href="#fn:1">1</a></sup>. Marionette implements its render cycle through 2 primary methods available in all of its base View classes.  The first is <code>serializeData</code>. serializeData is a function that produces what is essentially a <code>ViewModel</code> in the sense of an MVVM application. It takes your data (a Backbone Model or Collection), and pulls it into a simplified form that a View can easily render.  By default Marionette will simply call the Model or Collection’s <code>toJSON</code> function to serialize the Backbone object down into a simple JavaScript object.  But it’s possible to override serializeData to provide more complicated logic.  For instance here’s an example from the <a href="https://github.com/tastejs/todomvc/tree/gh-pages/examples/backbone_marionette">Marionette TodoMVC project</a> that takes a collection of todos and calculates a few values to show the number of completed todos.</p>
<pre><code class="language-javascript">serializeData: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> active = <span class="hljs-keyword">this</span>.collection.getActive().length;
    <span class="hljs-keyword">var</span> total = <span class="hljs-keyword">this</span>.collection.length;

    <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">activeCount</span>: active,
        <span class="hljs-attr">totalCount</span>: total,
        <span class="hljs-attr">completedCount</span>: total - active
    };
},
</code></pre>
<p>Once the serialized data/view model has been prepared, data is passed to the render function which starts by looking for a template to render.  In Marionette, templates are defined by setting the template property on your View, or by setting a getTemplate method if you want to conditionally load your templates. The render function takes that template, passes it the serialized data, and renders it using a template engine.  The default Marionette template engine is Underscore, which makes sense since it’s a Backbone dependency already.  But it’s easy to switch to a different templating engine.  Here’s the entire chunk of code I wrote to use Handlebar templates in Windsor Circle’s Marionette app.</p>
<pre><code class="language-javascript"><span class="hljs-comment">//render templates with Handlebars instead of Underscore</span>
Backbone.Marionette.Renderer.render = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">template, data</span>)</span>{
    <span class="hljs-keyword">var</span> renderer = Handlebars.compile(template);
    <span class="hljs-keyword">return</span> renderer(data);
};
</code></pre>
<h3>ItemView and CollectionView</h3>
<p>Marionette provides several View classes that you can use as bases, but the core Views for representing data are ItemView and CollectionView.  An ItemView takes a single data object, either a Model or Collection and passes it to the template to render.  A CollectionView iterates over a Collection and renders a child View for each Model. You can either use the same View for every Collection, or mix and match Views based on the Model’s properties.</p>
<p>So for instance, views for a simple todo list might look something like this <sup id="fnref:2"><a href="#fn:2">2</a></sup>:</p>
<pre><code class="language-javascript"><span class="hljs-keyword">var</span> TodoView= Marionette.ItemView.extend({
    <span class="hljs-attr">tagName</span>: <span class="hljs-string">'li'</span>,
    <span class="hljs-attr">template</span>: <span class="hljs-string">'&lt;span class="checkbox" {{checked}}&gt;&lt;/span&gt;&lt;span class="text"&gt;{{ text}}&lt;/span&gt;&lt;span class="delete"&gt;&lt;/span&gt;'</span>,
    <span class="hljs-attr">events</span>: {
        <span class="hljs-string">'click .checkbox'</span>: <span class="hljs-string">'toggleChecked'</span>,
        <span class="hljs-string">'click .delete'</span> : <span class="hljs-string">'deleteItem'</span>
    },

    <span class="hljs-attr">serializeData</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">checked</span>: <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'checked'</span>) ? <span class="hljs-string">'checked'</span>:<span class="hljs-string">''</span>,
            <span class="hljs-attr">text</span>: <span class="hljs-keyword">this</span>.model.get(<span class="hljs-string">'text'</span>)
        };
    },

    <span class="hljs-attr">toggleChecked</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-comment">//logic for checking the box</span>
    },

    <span class="hljs-attr">deleteItem</span> : <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-comment">//logic for deleting the todo</span>
    }
});

<span class="hljs-keyword">var</span> TodoListView = Marionette.CollectionView.extend({
    <span class="hljs-attr">childView</span>: TodoView,
    <span class="hljs-attr">tagName</span>: <span class="hljs-string">'ul'</span>

});
</code></pre>
<p>When the TodoListView is given a collection and rendered, it will display an unordered list of rendered TodoViews, with the data for each model bound to the template object associated with TodoView.</p>
<h3>A brief note on 2 way data-binding</h3>
<p>Marionette data-binding is one-way by default.  Over the last few years the discussion around data-binding has gone from “cool there’s structured data-binding” when Backbone first came out, to “how can you ship without 2-way data-bindings?” when Knockout, Angular and Ember popularized the 2-way approach, to “1 way bindings keep things simple and they’re cool again” based on the popularity of React.  I’m not going to go deep into that debate during this post, but the important takeaway is that Marionette generally prefers explicit bindings to implicit.  So when model values change, it will be based on code that you’ve written, not implicit library code.</p>
<h3>Wrap-Up</h3>
<p>I kept things pretty simple in this post, but consistent data binding is a core part of what Marionette provides.  Having a single documented system for attaching Model and Collection data to Views is a big win for keeping Backbone applications lean and readable.  When using these conventions you can move from View to View or project to project and quickly pick up on the intent and structure of the code.  Instead of trying to solve these problems for every  View, you can rely on the experience of others and focus on writing code to achieve your application’s goals.</p>
<p>This was a short but important start to diving deeper into Marionette. I’ll talk more about layouts, view life-cycles, and other Marionette features in future posts, but at their heart, web applications are about exposing data in rich UIs.  Without that core, your web applications won’t have much function at all.  So make sure to understand and take advantage of this aspect of Marionette before you move on to anything else.</p>
<h3>More Resources</h3>
<ul>
<li>If you absolutely must have 2 way data bindings in Backbone, <a href="http://nytimes.github.io/backbone.stickit/">Backbone.stickit</a> is a good project to check out.  At Windsor Circle we use it for binding model data to forms (2 way data-binding’s best use case).  Rather than the template based approach most libaries use for 2 way data-binding, stickit allows you to configure bindings declaratively in your view code.</li>
</ul>
<h3>Subscribe</h3>
<p>Thanks for taking the time to read this post! This was the second post in a <a href="http://benmccormick.org/tag/marionette-explained/">series</a> on developing web applications with Marionette.js, so if you enjoyed the post, please consider subscribing by using the <a href="http://feedpress.me/benmccormick">feed</a>, <a href="http://twitter.com/benmccormickorg">Twitter</a> or my <a href="http://eepurl.com/WFYon">mailing list</a>. You also might want to check out the <a href="http://benmccormick.org/2014/12/02/the-case-for-marionette-js/">first post</a> in the series, The Case For Marionette.js.</p>
<div class="footnotes">
<ol>
    <li class="footnote" id="fn:1">
        <p>
        MVVM is normally associated with 2 ways bindings though, which Backbone and Marionette do not provide
        </p>
        <a href="#fnref:1" title="return to article"> ↩</a></p>
    </li>
    <li class="footnote" id="fn:2">
        <p>
        In practice Marionette developers would likely use a ui hash on the TodoView, pull the template out into a separate file, and might have the CollectionView be a CompositeView to provide structure around the list.  But I'll dive into all of those things in more detail in future posts.
        </p>
        <a href="#fnref:2" title="return to article"> ↩</a></p>
    </li>
</ol>
</div>
</div><hr style="margin-bottom:3.332rem;" data-reactid="21"/><noscript data-reactid="22"></noscript><p style="margin-bottom:4.165rem;" data-reactid="23"><!-- react-text: 24 -->Written by <!-- /react-text --><!-- react-text: 25 -->Ben McCormick<!-- /react-text --></p><div title="Marionette Explained: Connecting Data to Your Views" data-reactid="26"><div id="disqus_thread" data-reactid="27"></div><noscript data-reactid="28"><span data-reactid="29"><!-- react-text: 30 -->Please enable JavaScript to view the<!-- /react-text --><a href="http://disqus.com/?ref_noscript" data-reactid="31">comments powered by Disqus.</a></span></noscript><a href="http://disqus.com" class="dsq-brlink" data-reactid="32"><!-- react-text: 33 -->Blog comments powered by <!-- /react-text --><span class="logo-disqus" data-reactid="34">Disqus</span><!-- react-text: 35 -->.<!-- /react-text --></a></div></div><span style="display:block;clear:both;" data-reactid="36"> </span></div></div><script src="/bundle.js?t=1481341404318"></script><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-37323973-1', 'auto');
            ga('send', 'pageview');
        </script></body></html>