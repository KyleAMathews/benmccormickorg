<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><script type="text/javascript" src="//use.typekit.net/msd6bqv.js"></script><script type="text/javascript">try{Typekit.load();}catch(e){}</script><title data-react-helmet="true">Explaining Javascript: Closures | benmccormick.org</title><style>.header-link{color:hsla(0,0%,39%,.7)}.header-link:hover{color:#e2777a}.markdown pre{display:block;background:#fdf6e3;color:#657b83;overflow-y:hidden;padding:.2rem .5rem}.markdown pre code{background:none;border:none;border-radius:3px;display:inline-block;overflow:inherit;padding:0;white-space:inherit;word-wrap:normal;font-size:.7rem;line-height:1rem}code{border-radius:3px;white-space:pre;white-space:pre-wrap;white-space:pre-line;white-space:-pre-wrap;white-space:-o-pre-wrap;white-space:-moz-pre-wrap;white-space:-hp-pre-wrap;word-wrap:break-word;border:1px solid #ccc;display:inline;font-family:Inconsolata,monospace,serif;max-width:100%;overflow:auto;padding:0 .1625rem}.hljs,code{background:#fdf6e3;color:#657b83}.hljs{display:block;overflow-x:auto;padding:.5em}.hljs-comment,.hljs-quote{color:#93a1a1}.hljs-addition,.hljs-keyword,.hljs-selector-tag{color:#859900}.hljs-doctag,.hljs-literal,.hljs-meta .hljs-meta-string,.hljs-number,.hljs-regexp,.hljs-string{color:#2aa198}.hljs-name,.hljs-section,.hljs-selector-class,.hljs-selector-id,.hljs-title{color:#268bd2}.hljs-attr,.hljs-attribute,.hljs-class .hljs-title,.hljs-template-variable,.hljs-type,.hljs-variable{color:#b58900}.hljs-bullet,.hljs-link,.hljs-meta,.hljs-meta .hljs-keyword,.hljs-selector-attr,.hljs-selector-pseudo,.hljs-subst,.hljs-symbol{color:#cb4b16}.hljs-built_in,.hljs-deletion{color:#dc322f}.hljs-formula{background:#eee8d5}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}body,h1,h2,h3,h4,h5,h6,p{font-family:brandon-grotesque,Brandon Grotesque,Helvetica Neue,Helvetica,Arial,Lucida Sans,Geneva,Verdana,sans-serif;text-rendering:optimizeLegibility}a{color:#e2777a;text-decoration:none}blockquote{border-left:5px solid #57a3e8;font-style:italic;background:#eee;font-weight:400;font-size:.9rem;padding:10px 20px;margin:0 0 30px -25px}h2,h3{color:#57a3e8}.explanation{padding:10px;background:#eee;border-radius:10px;margin:20px auto;font-size:.85em}.reading-img img{width:150px;float:right;margin:10px}</style></head><body class="landing-page" style="background:#FCFCFC;"><div id="react-mount"><div style="max-width:39.984rem;margin-left:auto;margin-right:auto;padding:2.499rem 1.2495rem;" data-reactroot="" data-reactid="1" data-react-checksum="-1502028738"><div style="display:flex;padding-bottom:0.5rem;margin-bottom:0.5rem;" data-reactid="2"><div style="flex-grow:3;display:flex;flex-direction:column;justify-content:space-around;" data-reactid="3"><h3 style="margin:0;padding-bottom:0;" data-reactid="4"><a style="box-shadow:none;text-decoration:none;color:inherit;" href="/benmccormickorg/" data-reactid="5">benmccormick.org</a></h3><div style="color:rgba(100,100,100, 0.7);" data-reactid="6"><a class="header-link" href="/benmccormickorg/subscribe/" data-reactid="7">Subscribe</a><span style="padding:0 0.33rem;" data-reactid="8">•</span><a class="header-link" href="/benmccormickorg/readinglist/" data-reactid="9">Reading List</a><span style="padding:0 0.33rem;" data-reactid="10">•</span><a class="header-link" href="http://twitter.com/ben336" data-reactid="11">Twitter</a><span style="padding:0 0.33rem;" data-reactid="12">•</span><a class="header-link" href="/benmccormickorg/about/" data-reactid="13">About</a></div></div><div style="flex-shrink:2;" data-reactid="14"><div data-reactid="15"><a href="https://www.amazon.com/Effective-JavaScript-Specific-Software-Development/dp/0321812182/ref=as_li_ss_il?ie=UTF8&amp;linkCode=li1&amp;tag=benmccormicko-20&amp;linkId=204d9fef609d10bc79cb424fc44fd1ab" target="_blank" data-reactid="16"><div style="max-height:6.5rem;display:flex;justify-content:flex-end;background:#F0F0F0;padding:0.2rem;" data-reactid="17"><div data-reactid="18"><img src="//ws-na.amazon-adsystem.com/widgets/q?_encoding=UTF8&amp;ASIN=0321812182&amp;Format=_SL110_&amp;ID=AsinImage&amp;MarketPlace=US&amp;ServiceVersion=20070822&amp;WS=1&amp;tag=benmccormicko-20" data-reactid="19"/><img src="https://ir-na.amazon-adsystem.com/e/ir?t=benmccormicko-20&amp;l=li1&amp;o=1&amp;a=0321812182" width="1" height="1" alt="" style="border:none;margin:0px;" data-reactid="20"/></div><div style="font-size:0.6em;line-height:1em;max-width:5rem;padding:0 0.5rem;display:flex;align-items:center;flex-direction:column;justify-content:space-between;color:rgba(100, 100, 100, 0.701961);" data-reactid="21"><span data-reactid="22">Please support this blog by shopping on Amazon</span><a href="/benmccormickorg/amazonlinks" data-reactid="23">What is this?</a></div></div></a></div></div></div><div class="markdown" data-reactid="24"><!-- react-empty: 25 --><h5 style="display:block;color:rgba(100,100,100, 0.7);margin-bottom:0.4165rem;" data-reactid="26">January 8, 2013</h5><h1 style="margin-top:0;margin-bottom:1rem;" data-reactid="27">Explaining Javascript: Closures</h1><div class="article-body" data-reactid="28"><p>Javascript can be a confusing language when you start to use it.  Designed in a hurry with a functional programming heart and an object oriented skin, Javascript looks a lot like Java or C at first glance.  That expectation causes frustration though when you realize that writing Java style code means that you have no private variables, no block scope, no threads, and no abstract/classes or interfaces.  When I started writing Javascript I had only ever written in pure object oriented languages.  My javascript code was inefficient, fragile, and no fun to write.  I wanted to share some of the things I’ve learned since here, to help other people making that adjustment.</p>
<h3>Closures</h3>
<p>Closures are one of the key concepts to understand when you start writing Javascript.  By default, all javascript objects are global, and blocks such as for loops and if statements do not restrict scope.  Closures are Javascript’s mechanism for information hiding and controlling scope.  They also allow for some advanced functionality in an elegant way.</p>
<h4>Laying the ground</h4>
<p>There are a few things you need to understand about Javascript before closures make sense.</p>
<h4>Functions are objects</h4>
<p>Javascript uses First Class Functions, meaning that Functions are Objects in Javascript.  They can be passed to other functions, assigned properties, and be added as properties of another object.  This is very important to understand about Javascript, and a big difference between Javascript and Java/C++.</p>
<pre><code class="language-javascript">    <span class="hljs-keyword">var</span> f = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x</span>)</span>{
        <span class="hljs-keyword">return</span> x*<span class="hljs-number">2</span>;
    }
    f(<span class="hljs-number">3</span>);<span class="hljs-comment">//6</span>
    <span class="hljs-keyword">var</span> f2 = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">func, param</span>)</span>{
        <span class="hljs-keyword">return</span> func(param) + <span class="hljs-number">1</span>;
    }

    f2(f,<span class="hljs-number">5</span>); <span class="hljs-comment">// 11</span>
</code></pre>
<h4>Functions have their own scope</h4>
<p>Functions are effectively the only construct in Javascript that can limit scope.  Unlike other languages, code blocks don’t automatically limit scope.  So variables defined in for loops and if statements are not confined to those constructs, and Javascript doesn’t have an exact equivalent to javascript classes.  Instead functions are used to manage scope.  The key point is that from within a function you can reference variables defined outside the function, but you cannot access variables defined within a function from outside that function.</p>
<pre><code class="language-javascript">    <span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>;

    <span class="hljs-keyword">var</span> f = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-keyword">var</span> b = <span class="hljs-number">2</span>;
        alert(a);
        alert(b);
    }
    f();<span class="hljs-comment">// alerts 1, alerts 2</span>
    a = <span class="hljs-number">3</span>;
    f(); <span class="hljs-comment">//alerts 3, alerts 2</span>
    alert(b) <span class="hljs-comment">// undefined</span>
</code></pre>
<h4>Functions can be defined inside of other functions</h4>
<p>This naturally follows from the other two points.  Functions are just objects and can be defined anywhere.  So you can define a function inside another function, and use it as the return value of the outer function.</p>
<pre><code class="language-javascript">    <span class="hljs-keyword">var</span> outer = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{

        <span class="hljs-keyword">var</span> inner = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x</span>)</span>{
            <span class="hljs-keyword">return</span> x*<span class="hljs-number">2</span>;
        };
        <span class="hljs-keyword">return</span> inner;
    };
    <span class="hljs-keyword">var</span> a = outer();

    a(<span class="hljs-number">2</span>); <span class="hljs-comment">// 4</span>
</code></pre>
<h4>What is a Closure?</h4>
<p>A closure is a function defined inside of another function and returned by that function which maintains a reference to variables in the outer functions scope.  Since the inner function was created within the scope of the outer function, it can reference variables defined within the scope of the outer function.  This is best seen by example.</p>
<pre><code class="language-javascript">    <span class="hljs-keyword">var</span> outer = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-keyword">var</span> y = <span class="hljs-number">3</span>
        <span class="hljs-keyword">var</span> inner = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x</span>)</span>{
            <span class="hljs-keyword">return</span> x*y;
        };
        <span class="hljs-keyword">return</span> inner;
    };
    <span class="hljs-keyword">var</span> triple = outer();

    triple(<span class="hljs-number">2</span>); <span class="hljs-comment">// 6;</span>
    alert(y); <span class="hljs-comment">//undefined</span>
</code></pre>
<p>Since the outer function scope is maintained, you can also use the variables within that class to track state for the function so that it can only be modified through the function.  This is how javascript implements private variables.</p>
<pre><code class="language-javascript">    <span class="hljs-keyword">var</span> outer = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
        <span class="hljs-keyword">var</span> y = <span class="hljs-number">0</span>
        <span class="hljs-keyword">var</span> inner = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
            alert(y);
            y++;
        };
        <span class="hljs-keyword">return</span> inner;
    };
    <span class="hljs-keyword">var</span> message = outer();
    message() <span class="hljs-comment">// 0</span>
    message() <span class="hljs-comment">// 1</span>
    message() <span class="hljs-comment">// 2</span>
    message() <span class="hljs-comment">// 3</span>
    <span class="hljs-comment">//...</span>
</code></pre>
<h4>Closures in practice</h4>
<p>Closures are one of the most commonly used idioms in javascript.  They’re used anytime a programmer wants to protect their implementation of a feature, and prevent other code from directly referencing internal variables.  Its also the key concept in the popular <a href="http://www.adequatelygood.com/2010/3/JavaScript-Module-Pattern-In-Depth">module pattern</a>, and many more javascript patterns.  If you are writing javascript of any complexity, or need to understand other people’s javascript code, understanding closures is essential.</p>
<h2>Further Reading</h2>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Closures">Mozilla Documentation on Closures</a></li>
<li><a href="http://www.adequatelygood.com/2010/3/JavaScript-Module-Pattern-In-Depth">Ben Cherry on the Module Pattern</a></li>
<li><a href="http://www.amazon.com/Effective-JavaScript-Specific-Software-Development/dp/0321812182">Effective Javascript</a> is a great book for understanding javascript.  I wrote a review of it <a href="http://benmccormick.org/blog/2013/01/06/book-review-effective-javascript/">here</a></li>
</ul>
</div><hr style="margin-bottom:3.332rem;" data-reactid="29"/><noscript data-reactid="30"></noscript><p style="margin-bottom:4.165rem;" data-reactid="31"><!-- react-text: 32 -->Written by <!-- /react-text --><!-- react-text: 33 -->Ben McCormick<!-- /react-text --></p></div><span style="display:block;clear:both;" data-reactid="34"> </span></div></div><script src="/benmccormickorg/bundle.js?t=1474688792461"></script></body></html>